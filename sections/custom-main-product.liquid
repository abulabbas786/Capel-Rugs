{%- assign shipping_estimator_block = section.blocks | where: 'type', 'shipping_estimator' | first -%}
{%- assign variant_selector_block = section.blocks | where: 'type', 'variant_selector' | first -%}
{%- assign buy_buttons_block = section.blocks | where: 'type', 'buy_buttons' | first -%}
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.css"/>

<style>
.product-meta__vendor, .custom-product--template .product-meta .product-meta__share-buttons {
	display: none !important;
}
.custom_product_page .description_custom {
	padding-top: 10px;
}
.product-meta .product-meta__title.heading {
	font-size: 22px;
    margin-bottom: 14px;
}
.card__separator {
	margin: 14px 0;
}
.title-badge--wrapper {
	display: flex;
	justify-content: space-between;
	align-items: center;
	flex-wrap: wrap;
	grid-gap: 1rem;
}
.custom-variant {
	padding-block: 0 1rem;
	border-bottom: 1px solid #ccc;
	margin-bottom: 1rem;
}
.custom-variant h5 {
	margin-top: 1rem;
    font-weight: normal;
}
.custom-variant-select .base-fabric--slider, .custom-variant-select.select--base {
	display: flex;
	gap: 1rem;
	position: relative;
	overflow: auto;
	padding: 5px 1px;
	padding-bottom: 1rem;
}
.custom-variant-select.select--fabric:not(:last-child) {
	border-bottom: 1px solid #eee;
}
.custom-variant-select .slide-arrow {
	position: absolute;
	top: 50%;
	left: -1.25rem;
	transform: translateY(-50%);
	width: 2.5rem;
	height: 2.5rem;
	border-radius: 100%;
	background: var(--dark-black);
	border: none;
	padding: 0 !important;
	z-index: 2;
	opacity: 0;
    visibility: hidden;
	transition: 300ms ease-in-out;
}
.custom-variant-select:hover .slide-arrow:not(.slick-disabled) {
    opacity: 1;
    visibility: visible;
}
.custom-variant-select .slide-arrow.next-arrow {
	left: unset;
	right: -1.25rem;
}
.custom-variant-select .slide-arrow::before {
	content: '';
	position: absolute;
	inset: 0;
	background: url('https://cdn.shopify.com/s/files/1/0400/0199/4907/files/left-arrow.png?v=1674469787') no-repeat;
	background-position: center;
	background-size: 50%;
	opacity: 0.8;
	filter: invert(1);
}
.custom-variant-select .slide-arrow.next-arrow::before {
    transform: scaleX(-1);
}
.custom-variant-select--header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 1rem;
}
.custom-variant-select img {
	width: 90px;
	height: 90px;
	cursor: pointer;
	position: relative;
	transition: 0.3s all ease-in-out;
	object-fit: cover;
	box-shadow: rgba(0, 0, 0, 0.15) 1.95px 1.95px 2.6px;
}
.custom-variant-select.select--base img {
	height: auto;
}
.custom-variant-select .slick-track {
	display: flex;
	padding: 1px;
}
.custom-variant-select .slick-track > * {
	margin-right: 1rem;
}
.custom-variant-select .slick-list {
	margin-right: -1rem;
}
.custom-variant h4 {
	font-size: 1.2em;
}
.active-fabric-size, .active-fabric-base {
	border: 1px solid #ddd;
	padding: 3px;
}
.active-fabric-size {
	position: relative;
	width: 60px;
	height: 60px;
	display: grid;
	place-items: center;
}
.active-fabric-size input {
	position: absolute;
	background: ;
	inset: 0;
	opacity: 0;
}
.product-gallery__carousel-wrapper {
	z-index: 1;
	padding: 0;
	overflow: hidden;
	margin-bottom: 0.5rem;
}
.product-gallery__carousel-item {
	width: 100%;
	padding: 0;
	background: #fff;
}
.product-gallery__fabric {
	position: relative;
	width: 100%;
	height: 100%;
	background: #f3f4f5;
}
.product-gallery__carousel {
	position: absolute;
	inset: 0;
}
.preview-gallery-img {
	position: relative;
	width: 100%;
	height: 100%;
	background-size: 100%;
	background-repeat: no-repeat;
	-webkit-print-color-adjust: exact !important;
	color-adjust: exact !important;
	transition: 0.3s ease-in-out;
	display: none;
}
.product-gallery__carousel-wrapper:not(.product_views) .preview-gallery-img.corner-gallery-img {
    display: block;
}
.product-gallery__carousel-wrapper.product_views .preview-gallery-img.border-gallery-img {
    display: block;
}
.active-fabric , .active-special {
	outline: 1px solid var(--text-color) !important;
	padding: 3px;
}
.swatch-image {
	border-color: transparent !important;
}
.swatch-image.swatch-selected {
	border-color: var(--text-color) !important;
}
.swatch-image.swatch-selected .star-set-image {
	transform: scale(0.85);
}
.product-gallery__carousel-wrapper .product-gallery__fabric + .product-gallery__carousel {
	margin: 0;
	transform: translate(16%, 16%);
	transition: .3s ease-in-out;
}
.product-gallery__carousel-wrapper.product_views .product-gallery__fabric + .product-gallery__carousel {
	transform: translate(0) scale(0.84) scaleY(1.09) translateY(0.1rem);
	z-index: 2;
}
.changeView, .print-product-area {
	display: inline-block;
}
.changeView button, .print-product-area button {
	border: 1px solid;
	height: 45px;
	text-transform: capitalize;
	font-size: 15px;
	padding-inline: 25px;
}
.changeView button:not(.activeView) {
	background: transparent;
}
.changeView button.activeView:hover {
	background: var(--crm);
	color: var(--dark-black);
}
.custom-product--template .cool-image-loupe {
	opacity: 0;
	visibility: hidden;
}
.custom-product--template .product-gallery__image {
	pointer-events: none !important;
}
.product-gallery__carousel-wrapper:not(.product_views) {
/* 	height: 500px; */
    overflow: hidden;
}
.print-product-area {
	margin-top: 10px;
}
#print-iframe {
	opacity: 0;
}
.custom_product_page .product-block-list__item--gallery {
	width: min(500px, 100%);
	margin-inline: auto;
}
.custom_product_page .description_custom {
	width: calc(100% - 500px);
}
.view-all--fabric {
	font-size: 14px;
	line-height: 1.3;
	color: var(--link-color);
	text-transform: capitalize;
	background: transparent;
	text-decoration: underline;
	text-underline-offset: 3px;
	padding-right: 0;
	height: auto;
}
.view-all--fabric.view--modal:hover {
	background: transparent;
	color: var(--link-color-hover);
}
.all-fabric--modal {
	position: fixed;
	width: 100vw;
	height: 100vh;
	inset: 0;
	background: rgba(0,0,0,0);
	z-index: 999999;
	display: flex;
	justify-content: flex-end;
    transition: 100ms ease-in-out;
	visibility: visible;
	opacity: 1;
}
.all-fabric--modal:not(.active) {
	visibility: hidden;
	opacity: 0;
}
.all-fabric--wrapper {
	background: #fff;
	width: min(720px, 90%);
	height: 100vh;
	padding: 1rem 1.5rem;
	transform: translateX(100%);
	transition: 300ms ease-in-out;
	overflow: auto;
	border-left: 1px solid #ddd;
}
.all-fabric--modal.active .all-fabric--wrapper {
	transform: translateX(0%);
}
.all-fabric--header {
    display: flex;
    justify-content: space-between;
	border-bottom: 1px solid #ddd;
	padding-bottom: 1rem;
	margin-bottom: 2rem;
}
.all-fabric--header h3 {
	margin-bottom: 0;
	font-size: 1.3em;
	line-height: 2;
}
.all-fabric--images {
	display: flex;
	grid-gap: 1rem;
	flex-wrap: wrap;
	overflow: auto;
	padding-bottom: 1rem;
}
.all-fabric--images > * {
	width: calc(100% / 7);
	box-shadow: rgba(0, 0, 0, 0.15) 1.95px 1.95px 2.6px;
    cursor: pointer;
}
.close--modal {
	border-radius: 3px;
}
.all-fabric--wrapper .all-fabric--images {
	display: none;
}

.product-gallery__carousel .flickity-viewport {
	height: 100% !important;
}
@media (max-width: 900px) {
.custom_product_page .description_custom {
	width: 100%;
	padding-left: 0;
	margin-top: 1rem;
}
.all-fabric--images > * {
	width: calc(100% / 6);
}
.custom_product_page .product-block-list__item--gallery {
	width: 100%;
}
}

.product-gallery__carousel-wrapper .product_type_data {
	position: absolute;
	bottom: 1rem;
	left: 1rem;
	background: rgba(255,255,255,0.8);
	padding: 4px 14px;
	border-radius: 10rem;
	font-size: 14px;
    width: auto;
	height: 35px;
    cursor: pointer;
	transition: width 400ms linear;
    z-index: 2
}
.product_type_data span {
	padding-left: 30px;
}
.product_type_data::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	width: 35px;
	height: 35px;
	border-radius: 100%;
	background: url('https://cdn.shopify.com/s/files/1/0400/0199/4907/files/textile.png?v=1675684077') no-repeat;
	background-size: 75%;
	background-position: center;
	border: 2px solid #fff;
}

@media print {
body > *:not(main), body main > div:not(.custom-product--template-main), form.product-form > *:not(.product-meta), .price-list .price.price--compare,
.swatches.swatches-type-products .swatch-view.swatch-view-custom-image, .size_guide_wrapper, .variantAvailability,.product-form__payment-container,
.stamped-product-reviews-badge.stamped-main-badge, .product-block-list__item.product-block-list__item--content, #shopify-section-footer, #fabric_name,
.product-meta__share-buttons,.changeView, .print-product-area, .swatches, .product-block-list__item--description .rte > :not(ul), #fabric_name ~ li {
    display: none !important;
}
.product_type_data {
	overflow: visible !important;
	width: auto !important;
}
.description_custom .product-block-list__item .card .card__header h2 {
	margin-top: 0;
}
.product_type_data span {
	opacity: 1 !important;
}
.product-block-list__item.product-block-list__item--info .card.card--collapsed.card--sticky {
	position: static !important;
}
.product-gallery__carousel-wrapper.product_views {
	width: min(400px, 100%);
}
.product_type_data span {
    padding-left: 0;
}
.product_type_data::before {
	content: none;
}
  .product-gallery .product-gallery__carousel-wrapper{
    width: 75%;
    height: 75%;
  }
  .product-gallery .product-gallery__carousel-wrapper.product_views{
  width: 46%;
    height:50%;
  } 
.product-meta .product-meta__title.heading, .product-form__info-content .price-list .price {
	font-size: 28px;
	line-height: 1.2;
}
.description_custom .product-block-list__item .card .card__header h2 {
	font-size: 22px;
}
.product-block-list__item.product-block-list__item--description * {
	font-size: 18px;
}
/* @page {size: landscape} */
}
</style>

<script class="product-custom-json" type="application/json">
{
  "variants": [{% for variant in product.variants %}
    {
      "id": {{ variant.id | json }},
      "title": {{ variant.title | json }},
      "price": {{variant.price | json}},
      "option1": {{ variant.option1 | json }},
      "option2": {{ variant.option2 | json }},
      "option3": {{ variant.option3 | json }},
      "options": {{ product.options | json }},
      "sku": {{ variant.sku | json }},
      "metafields.global.discount":{{ variant.metafields.global.discount | json }},
      "metafields.global.availability":{{ variant.metafields.global.availability | prepend: '"' | append: '"' }},
      "metafields.global.SizeLimts":{{ variant.metafields.global.SizeLimts | prepend: '"' | append: '"' }},
      "metafields.global.WidLimit":{{ variant.metafields.global.WidLimit | json }},
      "metafields.global.LenLimit":{{ variant.metafields.global.LenLimit | json }},
      "metafields.global.RunWid":{{ variant.metafields.global.RunWid | json }},
      "metafields.global.RunLen":{{ variant.metafields.global.RunLen | json }},
      "metafields.global.WidList":{{ variant.metafields.global.WidList | json }},
      "metafields.global.WidListRun":{{ variant.metafields.global.WidListRun | json }}
    }
  {% unless forloop.last %},{% endunless %}
  {% endfor %}]
}
</script>

{%- capture section_settings -%}
{
  "showShippingEstimator": {% if template == 'product.quick-view' or product.available == false or shipping_estimator_block == blank %}false{% else %}true{% endif %},
  "showQuantitySelector": {{ variant_selector_block.settings.show_quantity_selector | json }},
  "showPaymentButton": {% if product.template_suffix == 'pre-order' %}false{% else %}{{ buy_buttons_block.settings.show_payment_button | json }}{% endif %},
  "showInventoryQuantity": {% if product.template_suffix != 'pre-order' %}{{ variant_selector_block.settings.show_inventory_quantity | json }}{% else %}false{% endif %},
  "lowInventoryThreshold": {{ variant_selector_block.settings.low_inventory_threshold | json }},
  "galleryTransitionEffect": {{ section.settings.carousel_effect | json }},
  "enableImageZoom": {% if template == 'product.quick-view' %}false{% else %}{{ section.settings.enable_image_zoom | json }}{% endif %},
  "zoomEffect": {{ section.settings.zoom_effect | json }},
  "enableVideoLooping": {{ section.settings.enable_video_looping | json }},
  "productOptions": {{ product.options | json | escape }},
  "enableHistoryState": {% if template == 'product.quick-view' %}false{% else %}true{% endif %},
  "infoOverflowScroll": {% if template == 'product.quick-view' %}false{% else %}true{% endif %},
  "isQuickView": {% if template == 'product.quick-view' %}true{% else %}false{% endif %}
}
{%- endcapture -%}

<section class="custom-product--template" data-selected="{{- product.selected_variant.option1 -}}" 
  data-template="{{ template }}" data-section-id="{{ section.id }}" 
  data-section-type="product" data-section-settings='{{ section_settings }}'>
  {%- if template != 'product.quick-view' -%}
    <div class="container container--flush">
    
      <div class="product-block-list product-block-list--{{ section.settings.image_size }}">
        <div class="product-block-list__wrapper custom_product_page">
          {%- if product.media.size > 0 -%}
            <div class="product-block-list__item product-block-list__item--gallery">
              {% render 'custom-product-gallery' %}
            </div>
          {%- endif -%}
	        <div class="description_custom">
          <div class="product-block-list__item product-block-list__item--info">
            {%- render 'custom-product-info' -%}
          </div>

          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- comment -%}
              --------------------------------------------------------------------------------------
              DESCRIPTION
              --------------------------------------------------------------------------------------
              {%- endcomment -%}

              {%- when 'description' -%}
                {%- if product.description != blank -%}
                  <div class="product-block-list__item product-block-list__item--description" {{ block.shopify_attributes }}>
                    <div class="card">
                      {%- if block.settings.display_mode == 'collapse' -%}
                        <button class="card__collapsible-button" data-action="toggle-collapsible" aria-expanded="false" aria-controls="block-{{ section.id }}-{{ block.id }}">
                          <span class="card__title heading h3">{{ 'product.general.description' | t }}</span>
                          <span class="plus-button plus-button--large"></span>
                        </button>

                        <div id="block-{{ section.id }}-{{ block.id }}" class="card__collapsible">
                          <div class="card__collapsible-content">
                            <div class="rte text--pull">
                              {{ product.description | remove: 'data-section-type="product"' }}
                            </div>
                          </div>
                        </div>
                      {%- else -%}
                        <div class="card__header">
                          <h2 class="card__title heading h3">{{ 'product.general.description' | t }}</h2>
                        </div>

                        <div class="card__section {% if block.settings.display_mode == 'view_more' %}expandable-content{% endif %}" {% if block.settings.display_mode == 'view_more' %}aria-expanded="false"{% endif %}>
                          <div class="rte text--pull">
                            {{ product.description | remove: 'data-section-type="product"' }}
                          </div>

                          {%- if block.settings.display_mode == 'view_more' -%}
                            <button class="expandable-content__toggle">
                              <span class="expandable-content__toggle-icon"></span>
                              <span class="expandable-content__toggle-text" data-view-more="{{ 'product.general.view_more' | t | escape }}" data-view-less="{{ 'product.general.view_less' | t | escape }}">{{- 'product.general.view_more' | t -}}</span>
                            </button>
                          {%- endif -%}
                        </div>
                      {%- endif -%}
                    </div>
                  </div>
                {%- endif -%}

              {%- when 'content' -%}
                {%- comment -%}
                --------------------------------------------------------------------------------------
                CONTENT (we first check the page and then inline content)
                --------------------------------------------------------------------------------------
                {%- endcomment -%}

                {%- assign page = block.settings.page -%}

                {%- if page != blank -%}
                  {%- assign title = page.title -%}
                  {%- assign content = page.content -%}
                {%- else -%}
                  {%- assign title = block.settings.title -%}
                  {%- assign content = block.settings.content -%}
                {%- endif -%}

                {%- if title != blank and content != blank -%}
                  <div class="product-block-list__item product-block-list__item--content" {{ block.shopify_attributes }}>
                    <div class="card">
                      {%- if block.settings.display_mode == 'collapse' -%}
                        <button class="card__collapsible-button" data-action="toggle-collapsible" aria-expanded="false" aria-controls="block-{{ section.id }}-{{ block.id }}">
                          <span class="card__title heading h3">{{ title }}</span>
                          <span class="plus-button plus-button--large"></span>
                        </button>

                        <div id="block-{{ section.id }}-{{ block.id }}" class="card__collapsible">
                          <div class="card__collapsible-content">
                            <div class="rte text--pull">
                              {{ content }}
                            </div>
                          </div>
                        </div>
                      {%- else -%}
                        <div class="card__header">
                          <h2 class="card__title heading h3">{{ title }}</h2>
                        </div>

                        <div class="card__section {% if block.settings.display_mode == 'view_more' %}expandable-content{% endif %}" {% if block.settings.display_mode == 'view_more' %}aria-expanded="false"{% endif %}>
                          <div class="rte text--pull">
                            {{ content }}
                          </div>

                          {%- if block.settings.display_mode == 'view_more' -%}
                            <button class="expandable-content__toggle">
                              <span class="expandable-content__toggle-icon"></span>
                              <span class="expandable-content__toggle-text" data-view-more="{{ 'product.general.view_more' | t | escape }}" data-view-less="{{ 'product.general.view_less' | t | escape }}">{{- 'product.general.view_more' | t -}}</span>
                            </button>
                          {%- endif -%}
                        </div>
                      {%- endif -%}
                    </div>
                  </div>
                {%- endif -%}
      		
        </div>
            {%- when 'liquid' -%}
              {%- comment -%}
              --------------------------------------------------------------------------------------
              LIQUID COE
              --------------------------------------------------------------------------------------
              {%- endcomment -%}

              {%- assign title = block.settings.title -%}
              {%- assign liquid = block.settings.liquid -%}

              {%- if title != blank and liquid != blank -%}
                <div class="product-block-list__item product-block-list__item--content" {{ block.shopify_attributes }}>
                  <div class="card">
                    {%- if block.settings.display_mode == 'collapse' -%}
                      <button class="card__collapsible-button" data-action="toggle-collapsible" aria-expanded="false" aria-controls="block-{{ section.id }}-{{ block.id }}">
                        <span class="card__title heading h3">{{ title }}</span>
                        <span class="plus-button plus-button--large"></span>
                      </button>

                      <div id="block-{{ section.id }}-{{ block.id }}" class="card__collapsible">
                        <div class="card__collapsible-content">
                          <div class="rte text--pull">
                            {{ liquid }}
                          </div>
                        </div>
                      </div>
                    {%- else -%}
                      <div class="card__header">
                        <h2 class="card__title heading h3">{{ title }}</h2>
                      </div>

                      <div class="card__section {% if block.settings.display_mode == 'view_more' %}expandable-content{% endif %}" {% if block.settings.display_mode == 'view_more' %}aria-expanded="false"{% endif %}>
                        <div class="rte text--pull">
                          {{ liquid }}
                        </div>

                        {%- if block.settings.display_mode == 'view_more' -%}
                          <button class="expandable-content__toggle">
                            <span class="expandable-content__toggle-icon"></span>
                            <span class="expandable-content__toggle-text" data-view-more="{{ 'product.general.view_more' | t | escape }}" data-view-less="{{ 'product.general.view_less' | t | escape }}">{{- 'product.general.view_more' | t -}}</span>
                          </button>
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                  </div>
                </div>
              {%- endif -%}

              {%- comment -%}
              --------------------------------------------------------------------------------------
              REVIEWS
              --------------------------------------------------------------------------------------
              {%- endcomment -%}
              {%- when 'reviews' -%}
                <div class="product-block-list__item product-block-list__item--reviews" {{ block.shopify_attributes }}>
                  <span id="product-reviews" class="anchor"></span>

                  <div class="card">
                    <div class="card__section">
                      {%- assign reviews_count = product.metafields.spr.reviews | split: '<meta itemprop="reviewCount" content="' | last | split: '">' | first | times: 1 -%}
                      <div id="shopify-product-reviews" class="spr-reviews {% if reviews_count > 0 %}spr-reviews--has-reviews{% endif %}" data-id="{{ product.id }}">{{ product.metafields.spr.reviews }}</div>
                    </div>
                  </div>
                </div>

              {%- comment -%}
              --------------------------------------------------------------------------------------
              TRUST BADGE
              --------------------------------------------------------------------------------------
              {%- endcomment -%}

              {%- when 'trust' -%}
                {%- if block.settings.show_payment_icons and shop.enabled_payment_types.size > 0 -%}
                  {%- assign show_payment_icons = true -%}
                {%- else -%}
                  {%- assign show_payment_icons = false -%}
                {%- endif -%}

                {%- if block.settings.custom_security_badge or show_payment_icons -%}
                  <div class="product-block-list__item product-block-list__item--trust">
                    <div class="card">
                      <div class="card__header card__header--flex">
                        <h2 class="card__title heading h3">{{ block.settings.trust_title | escape }}</h2>

                        {%- render 'icon', icon: 'lock', width: 22, height: 24 -%}
                      </div>

                      <div class="card__section">
                        {%- if show_payment_icons -%}
                          {%- if block.settings.custom_security_badge -%}
                            <p class="card__subtitle heading h6">{{ 'product.general.payment' | t }}</p>
                          {%- endif -%}

                          <div class="payment-list">
                            {% for type in shop.enabled_payment_types %}
                              {{ type | payment_type_svg_tag: class: 'payment-list__item' }}
                            {% endfor %}
                          </div>

                          <p class="payment-list__notice">{{ 'product.general.payment_notice' | t }}</p>
                        {%- endif -%}

                        {%- if show_payment_icons and block.settings.custom_security_badge -%}
                          <hr class="card__separator">
                        {%- endif -%}

                        {%- if block.settings.custom_security_badge -%}
                          {%- if show_payment_icons -%}
                            <p class="card__subtitle heading h6">{{ 'product.general.security' | t }}</p>
                          {%- endif -%}

                          {%- assign badge_width = block.settings.custom_security_badge.width | at_most: 450 | append: 'x' -%}
                          <img class="product__trust-badge" style="width: {{ block.settings.custom_security_badge_width }}px"
                               src="{{ block.settings.custom_security_badge | img_url: badge_width }}"
                               srcset="{{ block.settings.custom_security_badge | img_url: badge_width }} 1x, {{ block.settings.custom_security_badge | img_url: badge_width, scale: 2 }} 2x"
                               alt="{{ block.settings.custom_security_badge.alt | escape }}">
                        {%- endif -%}
                      </div>
                    </div>
                  </div>
                {%- endif -%}
          		

              {%- comment -%}
              --------------------------------------------------------------------------------------
              ESTIMATE SHIPPING
              --------------------------------------------------------------------------------------
              {%- endcomment -%}

              {%- when 'shipping_estimator' -%}
                {%- if product.available -%}
                  <div class="product-block-list__item product-block-list__item--shipping" {{ block.shopify_attributes }}>
                    <div class="card">
                      <div class="card__header">
                        <h2 class="card__title heading h3">{{ 'product.general.estimate_shipping' | t }}</h2>
                      </div>

                      <div class="card__section">
                        <div class="shipping-estimator form" role="form">
                          <div class="form__input-row">
                            <div class="form__input-wrapper">
                              <label for="shipping-estimator-country" class="form__label">{{ 'cart.shipping_estimator.country' | t }}</label>

                              <div class="select-wrapper select-wrapper--primary">
                                {%- render 'icon', icon: 'arrow-bottom' -%}

                                <select name="country" id="shipping-estimator-country" data-default="{{ customer.default_address.country | default: block.settings.shipping_estimator_default_country }}" required>
                                  {{- country_option_tags -}}
                                </select>
                              </div>
                            </div>

                            <div class="form__input-wrapper" style="display: none">
                              <label for="shipping-estimator-province" class="form__label">{{ 'cart.shipping_estimator.province' | t }}</label>

                              <div class="select-wrapper select-wrapper--primary">
                                {%- render 'icon', icon: 'arrow-bottom' -%}

                                <select name="province" id="shipping-estimator-province" data-default="{{ customer.default_address.province }}"></select>
                              </div>
                            </div>

                            <div class="form__input-wrapper" style="max-width: 155px">
                              <label for="shipping-estimator-zip" class="form__label">{{ 'cart.shipping_estimator.zip_code' | t }}</label>
                              <input type="text" name="zip" id="shipping-estimator-zip" class="form__field form__field--text" value="{{ customer.default.address.zip }}" required>
                            </div>
                          </div>

                          <button type="button" class="form__submit button button--primary" data-action="estimate-shipping">{{ 'cart.shipping_estimator.estimate' | t }}</button>

                          <div class="shipping-estimator__results rte" style="display: none;"></div>
                        </div>
                      </div>

                      {%- if block.settings.show_refunds_policy and shop.refund_policy != blank -%}
                        <div class="card__section card__section--tight">
                          <button class="product__refund-policy-link link link--accented" data-action="open-modal" aria-controls="modal-refunds-policy">{{ 'product.general.refund_policy' | t }} {%- render 'icon', icon: 'arrow-right' -%}</button>
                        </div>
                      {%- endif -%}
                    </div>

                    {%- if block.settings.show_refunds_policy and shop.refund_policy != blank -%}
                      <div id="modal-refunds-policy" class="modal" aria-hidden="true">
                        <div class="modal__dialog" role="dialog">
                          <header class="modal__header">
                            <h3 class="modal__title heading h2">{{ 'product.general.refund_policy' | t }}</h3>
                            <button class="modal__close link" data-action="close-modal" title="{{ 'general.accessibility.close' | t | escape }}">
                              {%- render 'icon', icon: 'close' -%}
                            </button>
                          </header>

                          <div class="modal__content">
                            <div class="rte">
                              {{ shop.refund_policy }}
                            </div>
                          </div>
                        </div>
                      </div>
                    {%- endif -%}
                  </div>
                {%- endif -%}
            {%- endcase -%}
          {%- endfor -%}
        </div>
      </div>
    </div>
  {%- else -%}
    {%- comment -%}We display the quick view within the product template so we can re-use the same settings{%- endcomment -%}
    <div class="featured-product">
      {%- render 'product-gallery' -%}
      {%- render 'product-info' -%}
    </div>
  {%- endif -%}
  <iframe id="print-iframe" width="0" height="0"></iframe>
</section>

{% comment %} <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
	
<script>
// $('.custom-variant-select:not(.select--size) .base-fabric--slider, .custom-variant-select.select--base').slick({
//   dots: false,
//   infinite: false,
//   speed: 300,
//   slidesToShow: 10,
//   slidesToScroll: 1,
//   prevArrow: '<button type="button" class="slide-arrow prev-arrow" ></button>',
//   nextArrow: '<button type="button" class="slide-arrow next-arrow" ></button>',
//   responsive: [
//     {
//       breakpoint: 1200,
//       settings: {
//         slidesToShow: 6
//       }
//     },
//     {
//       breakpoint: 1080,
//       settings: {
//         slidesToShow: 4
//       }
//     }
//   ]
// });
</script> {% endcomment %}

<script>
  window.ShopifyXR=window.ShopifyXR||function(){(ShopifyXR.q=ShopifyXR.q||[]).push(arguments)};
  ShopifyXR('addModels', {{ product.media | where: 'media_type', 'model' | json }});

  // We save the ID of the product in the local storage, as it can be used by the "recently viewed products" section
  (() => {
    let items = JSON.parse(localStorage.getItem('recentlyViewedProducts') || '[]');

    // If the product already exists we first remove it
    if (items.includes({{product.id | json}})) {
      items.splice(items.indexOf({{ product.id | json }}), 1);
    }

    items.unshift({{ product.id | json }});

    // Then, we save the current product into the local storage, by keeping only the 18 most recent
    try {
      localStorage.setItem('recentlyViewedProducts', JSON.stringify(items.slice(0, 18)));
    } catch (error) {
      // Do nothing, this may happen in Safari in incognito mode
    }
  })();
</script>


<script>
  (()=>{
    let addSpacesToCapitalizedString = str => str.replace(/([A-Z])/g, ' $1'); 
    document.querySelectorAll('div.select--base img').forEach(img => {
      img.title = addSpacesToCapitalizedString(img.title)
    })
    document.querySelectorAll('div.base-fabric--slider img, .select--fabric img').forEach(img => {
      img.title = addSpacesToCapitalizedString(img.title)
      img.dataset.styleNumber = img.title;
    })
  })();
</script>

{% schema %}
{
  "name": "Custom Product",
  "class": "custom-product--template-main",
  "blocks": [
    {
      "type": "product_meta",
      "name": "Product meta",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_vendor",
          "label": "Show vendor",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_sku",
          "label": "Show SKU",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "show_reviews_badge",
          "label": "Show product rating",
          "info": "To display a rating, add a product rating app. [Learn more](https://help.shopify.com/en/manual/products/product-reviews/installation)",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "show_share_buttons",
          "label": "Show share buttons",
          "default": true
        }
      ]
    },
    {
      "type": "variant_selector",
      "name": "Variant selector",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "selector_mode",
          "label": "Selector type",
          "options": [
            {
              "value": "block",
              "label": "Block"
            },
            {
              "value": "dropdown",
              "label": "Dropdown"
            }
          ],
          "default": "block"
        },
        {
          "type": "select",
          "id": "color_mode",
          "label": "Color selector type",
          "info": "Variant image mode requires that all variant has an associated image. [Learn more](https://help.shopify.com/en/manual/products/product-variant-images#add-images-to-existing-variants)",
          "options": [
            {
              "value": "block",
              "label": "Block"
            },
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "color",
              "label": "Color swatch"
            },
            {
              "value": "variant_image",
              "label": "Variant image"
            }
          ],
          "default": "color"
        },
        {
          "type": "checkbox",
          "id": "show_quantity_selector",
          "label": "Show quantity selector",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_taxes_included",
          "label": "Show price taxes notice",
          "default": false
        },
        {
          "type": "header",
          "content": "Inventory"
        },
        {
          "type": "paragraph",
          "content": "You can also add a stock countdown. [Learn more](https://support.maestrooo.com/article/177-product-show-an-stock-countdown-bar)."
        },
        {
          "type": "checkbox",
          "id": "show_inventory_quantity",
          "label": "Show inventory quantity",
          "default": false
        },
        {
          "type": "range",
          "id": "low_inventory_threshold",
          "label": "Low inventory threshold",
          "info": "Use low stock color when quantity is below the threshold. Choose 0 to always show in stock.",
          "min": 0,
          "max": 100,
          "step": 1,
          "default": 0
        }
      ]
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_payment_button",
          "label": "Show dynamic checkout button",
          "info": "Each customer will see their preferred payment method from those available on your store, such as PayPal or Apple Pay. [Learn more](https://help.shopify.com/manual/using-themes/change-the-layout/dynamic-checkout)",
          "default": true
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "paragraph",
          "content": "This text will appear on the right part of the page."
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Text"
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "type": "paragraph",
          "content": "This button will appear on the right part of the page."
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    },
    {
      "type": "store_pickup",
      "name": "Local pickup availability",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": "Show customers where they can pick up the product. [Learn more](https://help.shopify.com/en/manual/shipping/setting-up-and-managing-your-shipping/local-methods/local-pickup#show-pickup-availability-to-your-customers)"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "display_mode",
          "label": "Display mode",
          "options": [
            {
              "value": "collapse",
              "label": "Collapse"
            },
            {
              "value": "view_more",
              "label": "Show view more if long"
            },
            {
              "value": "show_all",
              "label": "Show all"
            }
          ],
          "default": "show_all"
        }
      ]
    },
    {
      "type": "content",
      "name": "Content",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Content from page",
          "info": "If specified, takes precedence over inline content."
        },
        {
          "type": "select",
          "id": "display_mode",
          "label": "Display mode",
          "options": [
            {
              "value": "collapse",
              "label": "Collapse"
            },
            {
              "value": "view_more",
              "label": "Show view more if long"
            },
            {
              "value": "show_all",
              "label": "Show all"
            }
          ],
          "default": "show_all"
        }
      ]
    },
    {
      "type": "liquid",
      "name": "Liquid",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "liquid",
          "id": "liquid",
          "label": "Liquid code",
          "default": "{{ product.title }}"
        },
        {
          "type": "select",
          "id": "display_mode",
          "label": "Display mode",
          "options": [
            {
              "value": "collapse",
              "label": "Collapse"
            },
            {
              "value": "view_more",
              "label": "Show view more if long"
            },
            {
              "value": "show_all",
              "label": "Show all"
            }
          ],
          "default": "show_all"
        }
      ]
    },
    {
      "type": "reviews",
      "name": "Reviews",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": "You need to install [Shopify's free Product Reviews](https://apps.shopify.com/product-reviews) app before enabling those options."
        }
      ]
    },
    {
      "type": "shipping_estimator",
      "name": "Shipping estimator",
      "settings": [
        {
          "type": "text",
          "id": "shipping_estimator_default_country",
          "label": "Default country",
          "info": "If the customer is logged in, the country of their shipping address will be used.",
          "default": "United States"
        },
        {
          "type": "checkbox",
          "id": "show_refunds_policy",
          "label": "Show refunds policy",
          "info": "Refund policy must be added into your store policies. [Learn more](https://help.shopify.com/manual/sell-online/checkout-settings/refund-privacy-tos).",
          "default": true
        }
      ]
    },
    {
      "type": "trust",
      "name": "Trust content",
      "settings": [
        {
          "type": "text",
          "id": "trust_title",
          "label": "Heading",
          "default": "Payment & Security"
        },
        {
          "type": "checkbox",
          "id": "show_payment_icons",
          "label": "Show payment icons",
          "default": true
        },
        {
          "type": "image_picker",
          "id": "custom_security_badge",
          "label": "Security badge",
          "info": "800 x 200px .jpg recommended"
        },
        {
          "type": "range",
          "id": "custom_security_badge_width",
          "min": 100,
          "max": 500,
          "step": 10,
          "unit": "px",
          "label": "Security badge width",
          "default": 200
        }
      ]
    },
    {
      "type": "@app"
    }
  ],
  "settings": [
    {
      "type": "header",
      "content": "Custom Variant Content"
    },
    {
      "type": "text",
      "id": "fabric_label",
      "label": "Fabric Label",
      "default": "Fabric"
    },
    {
      "type": "text",
      "id": "upload_label",
      "label": "Upload File Label",
      "default": "Click Here To Upload Fabric Image"
    },
    {
      "type": "text",
      "id": "fabric_swatch",
      "label": "Fabric Swatch Label",
      "default": "OR Select Fabric"
    },
    {
      "type": "text",
      "id": "fabric_color",
      "label": "Fabric Color",
      "info": "Add fabric color metfield"
    },
    {
      "type": "text",
      "id": "fabric_solid",
      "label": "Fabric Solid",
      "info": "Add fabric solid metfield"
    },
    {
      "type": "text",
      "id": "fabric_stripes",
      "label": "Fabric Stripes",
      "info": "Add fabric stripes metfield"
    },
    {
      "type": "text",
      "id": "fabric_patterns",
      "label": "Fabric Patterns",
      "info": "Add fabric patterns metfield"
    },
    {
      "type": "text",
      "id": "fabric_size_label",
      "label": "Fabric Size Label",
      "default": "Select Fabric Size"
    },
    {
      "type": "text",
      "id": "fabric_size",
      "label": "Fabric Size",
      "info": "Add fabric size metfield"
    },
  
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "paragraph",
      "content": "Learn more about [media types](https://help.shopify.com/en/manual/products/product-media)"
    },
    {
      "type": "select",
      "id": "image_size",
      "label": "Size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "small"
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "label": "Enable video looping",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_image_zoom",
      "label": "Enable image zoom",
      "default": true
    },
    {
      "type": "select",
      "id": "zoom_effect",
      "label": "Desktop zoom effect",
      "options": [
        {
          "value": "inside",
          "label": "Inside"
        },
        {
          "value": "outside",
          "label": "Outside"
        }
      ],
      "default": "outside"
    },
    {
      "type": "select",
      "id": "carousel_effect",
      "label": "Transition effect",
      "options": [
        {
          "value": "fade",
          "label": "Fade"
        },
        {
          "value": "slide",
          "label": "Slide"
        }
      ],
      "default": "fade"
    }
  ]
}
{% endschema %}